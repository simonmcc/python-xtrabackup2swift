#!/usr/bin/env python

import os
import logging
import time
from socket import gethostname

import xtrabackup2swift


use_swift = True


(options, args) = xtrabackup2swift.cli_options()

log_file = options.log_file

opt_auth_url = options.opt_auth_url
if opt_auth_url == "":
    opt_auth_url = os.environ.get('OS_AUTH_URL', '')

opt_tenant_name = options.opt_tenant_name
if opt_tenant_name == "":
    opt_tenant_name = os.environ.get('OS_TENANT_NAME', '')

opt_password = options.opt_password
if opt_password == "":
    opt_password = os.environ.get('OS_PASSWORD', '')

opt_username = options.opt_username
if opt_username == "":
    opt_username = os.environ.get('OS_USERNAME', '')

opt_container = options.opt_container
if opt_container == "":
    opt_container = os.environ.get('BACKUP_CONTAINER', 'db_backup')

logging.StreamHandler(stream=log_file)

logging.basicConfig(filename=log_file,
                    level=logging.INFO)

LOG = logging.getLogger(__name__)

if __name__ == '__main__':
    xtrabackup2swift.run_backup(options)
